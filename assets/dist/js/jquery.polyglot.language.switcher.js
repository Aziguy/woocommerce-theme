(function($){$.timer=function(func,time,autostart){return this.set=function(func,time,autostart){if(this.init=!0,"object"==typeof func){var paramList=["autostart","time"];for(var arg in paramList)null!=func[paramList[arg]]&&eval(paramList[arg]+" = func[paramList[arg]]");func=func.action}return"function"==typeof func&&(this.action=func),isNaN(time)||(this.intervalTime=time),autostart&&!this.active&&(this.active=!0,this.setTimer()),this},this.once=function(t){var e=this;return isNaN(t)&&(t=0),window.setTimeout((function(){e.action()}),t),this},this.play=function(t){return this.active||(t?this.setTimer():this.setTimer(this.remaining),this.active=!0),this},this.pause=function(){return this.active&&(this.active=!1,this.remaining-=new Date-this.last,this.clearTimer()),this},this.stop=function(){return this.active=!1,this.remaining=this.intervalTime,this.clearTimer(),this},this.toggle=function(t){return this.active?this.pause():t?this.play(!0):this.play(),this},this.reset=function(){return this.active=!1,this.play(!0),this},this.clearTimer=function(){window.clearTimeout(this.timeoutObject)},this.setTimer=function(t){var e=this;"function"==typeof this.action&&(isNaN(t)&&(t=this.intervalTime),this.remaining=t,this.last=new Date,this.clearTimer(),this.timeoutObject=window.setTimeout((function(){e.go()}),t))},this.go=function(){this.active&&(this.action(),this.setTimer())},this.init?new $.timer(func,time,autostart):(this.set(func,time,autostart),this)},$.fn.polyglotLanguageSwitcher=function(t){var e,i,n=$.fn.polyglotLanguageSwitcher,a=$(this),r=$(this).attr("id"),s=$('<ul class="dropdown">'),o=0,c=!1,h=[],f=$.extend({},n.defaults,t),u="static"==f.websiteType;function l(t){f[t.name]&&f[t.name].call($(this),t)}function m(){c||(l({name:"beforeOpen",element:a,instance:n}),e.addClass("active"),g(!0),setTimeout((function(){c=!0,l({name:"afterOpen",element:a,instance:n})}),100))}function d(){c&&(l({name:"beforeClose",element:a,instance:n}),g(!1),e.removeClass("active"),c=!1,i&&i.active&&i.clearTimer(),l({name:"afterClose",element:a,instance:n}))}function p(){i&&i.active&&i.pause()}function v(){i&&i.play(!1)}function g(t){"fade"==f.effect?t?s.fadeIn(f.animSpeed):s.fadeOut(f.animSpeed):t?s.slideDown(f.animSpeed):s.slideUp(f.animSpeed)}function w(t){d();var i=$(t).children(":first-child"),n=$(i).attr("id"),a=$(i).text();$(s).children().each((function(){$(this).detach()}));for(var r=0;r<h.length;r++)$(h[r]).children(":first-child").attr("id")!=n&&s.append(h[r]);var o=e.children(":first-child");e.attr("id",n),e.text(a),e.append(o)}return function(){var t,i=$("#"+r+" > form > select > option");if(u){var c,d=window.location.href;i.each((function(){var t=$(this).attr("id");d.indexOf("/"+t+"/")>=0&&(c=t)}))}i.each((function(){var i,r=$(this).attr("id");i=u?c===r:$(this).attr("selected");var d=function(t){var e,i=$(t).attr("id"),r=$(t).attr("value"),s=$(t).text();if(u){var o=window.location.href,c=o.substring(o.lastIndexOf("/")+1),h="http://"+document.domain+"/"+f.pagePrefix+i+"/"+c;e=$('<li><a id="'+i+'" href="'+h+'">'+s+"</a></li>")}else{var m=document.URL.replace("#",""),d=function(){var t={},e=window.location.search.substr(1).split("&");if(e.length>0)for(var i=0;i<e.length;++i){var n=e[i].split("=");2==n.length&&(t[n[0]]=decodeURIComponent(n[1].replace(/\+/g," ")))}return t}();d[f.paramName]=r,m.indexOf("?")>0&&(m=m.substring(0,m.indexOf("?"))),m+=function(t){if(f.testMode)return"#";var e="?",i=0;for(var n in t){var a="";i>0&&(a="&"),e+=a+n+"="+t[n],i++}return e}(d),e=$('<li><a id="'+i+'" href="'+m+'">'+s+"</a></li>")}e.bind("click",(function(){l({name:"onChange",selectedItem:$(this).children(":first").attr("id"),element:a,instance:n}),w($(this))})),"hover"==f.openMode&&e.hover((function(){p()}),(function(){v()}));return e}($(this));i&&(t=d),h.push(d),o>0?s.append(d):(e=$('<a id="'+$(this).attr("id")+'" class="current" href="#">'+$(this).text()+' <span class="trigger"></span></a>'),"hover"==f.openMode?e.hover((function(){m(),p()}),(function(){v()})):e.click((function(){m()}))),o++})),$("#"+r+" form:first-child").remove(),a.append(e),a.append(s),t&&w(t)}(),$(document).click((function(){d()})),$(document).keyup((function(t){27==t.which&&d()})),"hover"==f.openMode&&(i=$.timer((function(){d()}))).set({time:f.hoverTimeout,autostart:!0}),n.open=function(){m()},n.close=function(){d()},l({name:"afterLoad",element:a,instance:n}),n};var ls=$.fn.polyglotLanguageSwitcher;ls.defaults={openMode:"click",hoverTimeout:1500,animSpeed:200,effect:"slide",paramName:"lang",pagePrefix:"",websiteType:"dynamic",testMode:!1,onChange:NaN,afterLoad:NaN,beforeOpen:NaN,afterOpen:NaN,beforeClose:NaN,afterClose:NaN}})(jQuery);